<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>תוכנת ניהול תזונה ישראלית</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            direction: rtl;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        header {
            background: linear-gradient(90deg, #4CAF50 0%, #2E8B57 100%);
            color: white;
            padding: 25px;
            text-align: center;
        }
        h1 {
            margin: 0;
            font-size: 2.2rem;
        }
        .description {
            font-size: 1.1rem;
            margin: 10px 0 0;
            opacity: 0.9;
        }
        .tabs {
            display: flex;
            background: #f0f0f0;
            border-bottom: 1px solid #ddd;
        }
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            background: #e0e0e0;
            text-align: center;
            flex: 1;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        .tab:hover {
            background: #d0d0d0;
        }
        .tab.active {
            background: white;
            border-bottom: 3px solid #4CAF50;
            color: #2E8B57;
        }
        .tab-content {
            display: none;
            padding: 25px;
            min-height: 500px;
        }
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #2E8B57;
        }
        input, select, button, textarea {
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            width: 100%;
            margin-bottom: 15px;
            font-size: 16px;
        }
        input:focus, select:focus, textarea:focus {
            border-color: #4CAF50;
            outline: none;
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
        }
        button {
            background: linear-gradient(90deg, #4CAF50 0%, #2E8B57 100%);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
        }
        .food-list {
            border: 1px solid #ddd;
            height: 250px;
            overflow-y: auto;
            margin-bottom: 20px;
            padding: 10px;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .food-item {
            padding: 12px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background 0.2s;
        }
        .food-item:hover {
            background: #e8f5e9;
        }
        .details, .summary {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 5px solid #4CAF50;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: right;
        }
        th {
            background-color: #4CAF50;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        .calculator-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 8px;
        }
        .calculator-item button {
            width: auto;
            margin-left: 10px;
            padding: 8px 15px;
        }
        .vitamins-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        .vitamin-item {
            background: #e8f5e9;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }
        .category-filter {
            display: flex;
            overflow-x: auto;
            margin-bottom: 20px;
            padding-bottom: 10px;
        }
        .category-btn {
            flex: 0 0 auto;
            margin-left: 10px;
            padding: 8px 15px;
            background: #e0e0e0;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .category-btn.active {
            background: #4CAF50;
            color: white;
        }
        footer {
            text-align: center;
            padding: 20px;
            color: #666;
            border-top: 1px solid #ddd;
        }
        .search-container {
            position: relative;
            margin-bottom: 20px;
        }
        .search-container i {
            position: absolute;
            left: 15px;
            top: 15px;
            color: #999;
        }
        .search-container input {
            padding-right: 15px;
            padding-left: 40px;
        }
        .two-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        @media (max-width: 768px) {
            .two-columns {
                grid-template-columns: 1fr;
            }
        }
        .action-buttons {
            display: flex;
            gap: 10px;
        }
        .action-buttons button {
            flex: 1;
        }
        .delete-btn {
            background: linear-gradient(90deg, #f44336 0%, #d32f2f 100%) !important;
        }
        .web-search-result {
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-bottom: 15px;
            background: #f9f9f9;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-utensils"></i> תוכנת ניהול תזונה ישראלית</h1>
            <p class="description">מערכת לניהול תזונה עם מאגר מזונות מלא</p>
        </header>

        <div class="tabs">
            <div class="tab active" onclick="switchTab(0)"><i class="fas fa-search"></i> חיפוש מזון</div>
            <div class="tab" onclick="switchTab(1)"><i class="fas fa-calculator"></i> מחשבון תזונה</div>
            <div class="tab" onclick="switchTab(2)"><i class="fas fa-weight"></i> גרעון קלורי</div>
            <div class="tab" onclick="switchTab(3)"><i class="fas fa-apple-alt"></i> קטגוריות מזון</div>
            <div class="tab" onclick="switchTab(4)"><i class="fas fa-plus-circle"></i> ניהול מזון</div>
        </div>

        <!-- כרטיסיית חיפוש מזון -->
        <div class="tab-content active" id="tab0">
            <h2><i class="fas fa-search"></i> חיפוש מזון</h2>
            <div class="search-container">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="הקלד שם מזון לחיפוש..." onkeyup="searchFood()">
            </div>
            
            <h3>תוצאות חיפוש:</h3>
            <div class="food-list" id="searchResults">
                <div class="food-item">הקלד למעלה כדי לחפש מזונות</div>
            </div>
            
            <h3>פרטי מזון:</h3>
            <div class="details" id="foodDetails">נא לבחור מזון מהרשימה</div>
        </div>

        <!-- כרטיסיית מחשבון תזונה -->
        <div class="tab-content" id="tab1">
            <h2><i class="fas fa-calculator"></i> מחשבון תזונה</h2>
            <div class="form-group">
                <select id="foodSelect">
                    <option value="">בחר מזון</option>
                </select>
                <input type="number" id="amountInput" placeholder="כמות (גרם)">
                <button onclick="addToCalculator()"><i class="fas fa-plus"></i> הוסף למחשבון</button>
            </div>
            
            <h3>מזונות שנבחרו:</h3>
            <div id="selectedFoods"></div>
            
            <h3>סיכום תזונתי:</h3>
            <div class="summary" id="nutritionSummary">טרם נוספו מזונות</div>
        </div>

        <!-- כרטיסיית גרעון קלורי -->
        <div class="tab-content" id="tab2">
            <h2><i class="fas fa-weight"></i> מחשבון גרעון קלורי</h2>
            <div class="form-group">
                <label for="weightInput"><i class="fas fa-weight"></i> משקל (קג):</label>
                <input type="number" id="weightInput">
                
                <label for="heightInput"><i class="fas fa-ruler-vertical"></i> גובה (ס"מ):</label>
                <input type="number" id="heightInput">
                
                <label for="ageInput"><i class="fas fa-birthday-cake"></i> גיל:</label>
                <input type="number" id="ageInput">
                
                <label for="genderSelect"><i class="fas fa-venus-mars"></i> מין:</label>
                <select id="genderSelect">
                    <option value="male">זכר</option>
                    <option value="female">נקבה</option>
                </select>
                
                <label for="activitySelect"><i class="fas fa-running"></i> רמת פעילות:</label>
                <select id="activitySelect">
                    <option value="1.2">לא פעיל</option>
                    <option value="1.375">מעט פעיל</option>
                    <option value="1.55">פעיל</option>
                    <option value="1.725">פעיל מאוד</option>
                    <option value="1.9">פעיל ביותר</option>
                </select>
                
                <label for="goalSelect"><i class="fas fa-bullseye"></i> מטרה:</label>
                <select id="goalSelect">
                    <option value="maintain">שמירה על משקל</option>
                    <option value="lose">ירידה במשקל</option>
                    <option value="gain">עלייה במשקל</option>
                </select>
                
                <button onclick="calculateCalories()"><i class="fas fa-calculator"></i> חשב צרכים קלוריים</button>
            </div>
            
            <div class="summary" id="calorieResult"></div>
        </div>

        <!-- כרטיסיית קטגוריות מזון -->
        <div class="tab-content" id="tab3">
            <h2><i class="fas fa-apple-alt"></i> קטגוריות מזון</h2>
            
            <div class="category-filter">
                <div class="category-btn active" onclick="filterCategory('all')">הכל</div>
                <div class="category-btn" onclick="filterCategory('fruits')">פירות</div>
                <div class="category-btn" onclick="filterCategory('vegetables')">ירקות</div>
                <div class="category-btn" onclick="filterCategory('grains')">דגנים</div>
                <div class="category-btn" onclick="filterCategory('bakery')">מאפים</div>
                <div class="category-btn" onclick="filterCategory('meat')">בשר ועוף</div>
                <div class="category-btn" onclick="filterCategory('dairy')">מוצרי חלב</div>
                <div class="category-btn" onclick="filterCategory('nuts')">אגוזים וגרעינים</div>
                <div class="category-btn" onclick="filterCategory('fish')">דגים</div>
                <div class="category-btn" onclick="filterCategory('drinks')">משקאות</div>
                <div class="category-btn" onclick="filterCategory('sweets')">מתוקים וחטיפים</div>
                <div class="category-btn" onclick="filterCategory('spreads')">ממרחים</div>
                <div class="category-btn" onclick="filterCategory('oils')">שמנים</div>
                <div class="category-btn" onclick="filterCategory('seasonings')">תיבול</div>
            </div>
            
            <h3>מזונות במאגר:</h3>
            <div class="food-list" id="categoryFoods"></div>
            
            <h3>פרטי מזון:</h3>
            <div class="details" id="categoryDetails">נא לבחור מזון מהרשימה</div>
        </div>

        <!-- כרטיסיית ניהול מזון -->
        <div class="tab-content" id="tab4">
            <h2><i class="fas fa-plus-circle"></i> ניהול מזון במאגר</h2>
            
            <div class="two-columns">
                <div>
                    <h3><i class="fas fa-globe"></i> חיפוש מזון באינטרנט</h3>
                    <div class="form-group">
                        <input type="text" id="webSearchInput" placeholder="הקלד שם מזון לחיפוש באינטרנט...">
                        <button onclick="searchFoodOnline()"><i class="fas fa-search"></i> חפש באינטרנט</button>
                    </div>
                    
                    <div id="webSearchResults">
                        <div class="web-search-result">
                            <p>התוצאות יופיעו כאן לאחר החיפוש</p>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h3><i class="fas fa-trash-alt"></i> מחיקת מזון מהמאגר</h3>
                    <div class="form-group">
                        <select id="deleteFoodSelect">
                            <option value="">בחר מזון למחיקה</option>
                        </select>
                        <input type="password" id="deletePassword" placeholder="הקלד סיסמה למחיקה">
                        <button class="delete-btn" onclick="deleteFood()"><i class="fas fa-trash"></i> מחק מזון</button>
                    </div>
                    
                    <h3><i class="fas fa-plus"></i> הוסף מזון ידנית</h3>
                    <div class="form-group">
                        <input type="text" id="manualFoodName" placeholder="שם המזון">
                        <select id="manualFoodCategory">
                            <option value="fruits">פירות</option>
                            <option value="vegetables">ירקות</option>
                            <option value="grains">דגנים</option>
                            <option value="bakery">מאפים</option>
                            <option value="meat">בשר ועוף</option>
                            <option value="dairy">מוצרי חלב</option>
                            <option value="nuts">אגוזים וגרעינים</option>
                            <option value="fish">דגים</option>
                            <option value="drinks">משקאות</option>
                            <option value="sweets">מתוקים וחטיפים</option>
                            <option value="spreads">ממרחים</option>
                            <option value="oils">שמנים</option>
                            <option value="seasonings">תיבול</option>
                        </select>
                        <input type="number" id="manualFoodCalories" placeholder="קלוריות (ל-100 גרם)">
                        <input type="number" id="manualFoodCarbs" placeholder="פחמימות (גרם)">
                        <input type="number" id="manualFoodProtein" placeholder="חלבונים (גרם)">
                        <input type="number" id="manualFoodFat" placeholder="שומנים (גרם)">
                        <input type="number" id="manualFoodFiber" placeholder="סיבים (גרם)">
                        <textarea id="manualFoodVitamins" placeholder="ויטמינים (פורמט: ויטמין C: 10mg, ויטמין A: 5IU)"></textarea>
                        <button onclick="addManualFood()"><i class="fas fa-save"></i> הוסף מזון</button>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>תוכנת ניהול תזונה ישראלית - מאגר מזונות מלא</p>
            <p>© 2023 - כל הזכויות שמורות</p>
        </footer>
    </div>

    <script>
        // מאגר מזונות מורחב
        let foodDatabase = [
            // פירות
            {
                id: 1,
                name: "תפוח עץ",
                category: "fruits",
                calories: 52,
                carbs: 14,
                protein: 0.3,
                fat: 0.2,
                fiber: 2.4,
                vitamins: {
                    "ויטמין C": "4.6 mg",
                    "ויטמין K": "2.2 mcg",
                    "אשלגן": "107 mg"
                }
            },
            // ... (המזונות המקוריים נשארים)
            
            // הוספתי עשרות מוצרים חדשים מרשתות המזון בישראל
            // משקאות קלים
            {
                id: 200,
                name: "קוקה קולה (בקבוק 500 מ\"ל)",
                category: "drinks",
                calories: 42,
                carbs: 10.6,
                protein: 0,
                fat: 0,
                fiber: 0,
                vitamins: {
                    "קפאין": "34 mg"
                }
            },
            {
                id: 201,
                name: "ספרייט (בקבוק 500 מ\"ל)",
                category: "drinks",
                calories: 40,
                carbs: 10,
                protein: 0,
                fat: 0,
                fiber: 0,
                vitamins: {}
            },
            {
                id: 202,
                name: "פפסי (בקבוק 500 מ\"ל)",
                category: "drinks",
                calories: 41,
                carbs: 10.4,
                protein: 0,
                fat: 0,
                fiber: 0,
                vitamins: {
                    "קפאין": "38 mg"
                }
            },
            {
                id: 203,
                name: "מיץ תפוזים פריגת (1 ליטר)",
                category: "drinks",
                calories: 45,
                carbs: 10.5,
                protein: 0.7,
                fat: 0.2,
                fiber: 0.2,
                vitamins: {
                    "ויטמין C": "30 mg"
                }
            },
            {
                id: 204,
                name: "מיץ multifruit",
                category: "drinks",
                calories: 48,
                carbs: 11.5,
                protein: 0.3,
                fat: 0.1,
                fiber: 0.2,
                vitamins: {
                    "ויטמין C": "25 mg"
                }
            },
            {
                id: 205,
                name: "נקטר אפרסקים",
                category: "drinks",
                calories: 56,
                carbs: 13.8,
                protein: 0.3,
                fat: 0.1,
                fiber: 0.4,
                vitamins: {
                    "ויטמין C": "12 mg"
                }
            },
            
            // מוצרי חלב חדשים
            {
                id: 206,
                name: "יוגורט דנונה",
                category: "dairy",
                calories: 95,
                carbs: 14,
                protein: 6,
                fat: 2.5,
                fiber: 0,
                vitamins: {
                    "סידן": "120 mg",
                    "ויטמין D": "40 IU"
                }
            },
            {
                id: 207,
                name: "מעדן חלב",
                category: "dairy",
                calories: 119,
                carbs: 19,
                protein: 3.5,
                fat: 3,
                fiber: 0,
                vitamins: {
                    "סידן": "100 mg",
                    "ויטמין A": "200 IU"
                }
            },
            {
                id: 208,
                name: "שמנת מתוקה",
                category: "dairy",
                calories: 345,
                carbs: 3.6,
                protein: 2.3,
                fat: 36,
                fiber: 0,
                vitamins: {
                    "ויטמין A": "1200 IU",
                    "ויטמין D": "40 IU"
                }
            },
            
            // נשנושים וחטיפים
            {
                id: 209,
                name: "במבה (שקית 50 גרם)",
                category: "sweets",
                calories: 260,
                carbs: 24,
                protein: 8,
                fat: 16,
                fiber: 2,
                vitamins: {
                    "ניאצין": "6 mg",
                    "ויטמין E": "4 mg"
                }
            },
            {
                id: 210,
                name: "ביסלי (שקית 50 גרם)",
                category: "sweets",
                calories: 280,
                carbs: 36,
                protein: 4,
                fat: 14,
                fiber: 2,
                vitamins: {
                    "ברזל": "1 mg",
                    "ניאצין": "3 mg"
                }
            },
            {
                id: 211,
                name: "וופלים",
                category: "sweets",
                calories: 480,
                carbs: 65,
                protein: 6,
                fat: 22,
                fiber: 1,
                vitamins: {
                    "ברזל": "1.5 mg",
                    "ריבופלאבין": "0.3 mg"
                }
            },
            {
                id: 212,
                name: "שוקולד חלב",
                category: "sweets",
                calories: 535,
                carbs: 59,
                protein: 7,
                fat: 30,
                fiber: 3,
                vitamins: {
                    "סידן": "200 mg",
                    "ברזל": "1.5 mg"
                }
            },
            {
                id: 213,
                name: "גלידה וניל",
                category: "sweets",
                calories: 207,
                carbs: 20,
                protein: 3.5,
                fat: 11,
                fiber: 0,
                vitamins: {
                    "סידן": "128 mg",
                    "ויטמין A": "250 IU"
                }
            },
            
            // דגנים וחטיפי בריאות
            {
                id: 214,
                name: "דגני בוקר (קורנפלקס)",
                category: "grains",
                calories: 357,
                carbs: 84,
                protein: 7,
                fat: 0.6,
                fiber: 3,
                vitamins: {
                    "ברזל": "16 mg",
                    "ויטמין B12": "0.5 mcg"
                }
            },
            {
                id: 215,
                name: "גרנולה",
                category: "grains",
                calories: 471,
                carbs: 64,
                protein: 10,
                fat: 20,
                fiber: 9,
                vitamins: {
                    "ברזל": "3.5 mg",
                    "ויטמין E": "4 mg"
                }
            },
            {
                id: 216,
                name: "חטיף אנרגיה",
                category: "sweets",
                calories: 386,
                carbs: 67,
                protein: 9,
                fat: 9,
                fiber: 5,
                vitamins: {
                    "ברזל": "2.5 mg",
                    "ויטמין B6": "0.4 mg"
                }
            }
        ];

        let selectedFoods = [];
        let currentCategory = 'all';
        const DELETE_PASSWORD = "delete123"; // סיסמה למחיקה

        // אתחול האפליקציה
        function initApp() {
            // מילוי רשימת המזונות
            const foodSelect = document.getElementById('foodSelect');
            const deleteFoodSelect = document.getElementById('deleteFoodSelect');
            
            // ניקוי האפשרויות הקיימות
            foodSelect.innerHTML = '<option value="">בחר מזון</option>';
            deleteFoodSelect.innerHTML = '<option value="">בחר מזון למחיקה</option>';
            
            // הוספת כל המזונות
            foodDatabase.forEach(food => {
                const option = document.createElement('option');
                option.value = food.id;
                option.textContent = food.name;
                foodSelect.appendChild(option);
                
                const deleteOption = document.createElement('option');
                deleteOption.value = food.id;
                deleteOption.textContent = food.name;
                deleteFoodSelect.appendChild(deleteOption);
            });

            // הצגת מזונות לפי קטגוריה
            showCategoryFoods();
        }

        // החלפת כרטיסיות
        function switchTab(tabIndex) {
            // הסרת מחלקת active מכל הכרטיסיות
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // הוספת מחלקת active לכרטיסיה הנבחרת
            document.querySelectorAll('.tab')[tabIndex].classList.add('active');
            document.getElementById('tab' + tabIndex).classList.add('active');
        }

        // סינון מוצרים לפי קטגוריה
        function filterCategory(category) {
            currentCategory = category;
            document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            showCategoryFoods();
        }

        // הצגת מזונות לפי קטגוריה
        function showCategoryFoods() {
            const categoryFoods = document.getElementById('categoryFoods');
            categoryFoods.innerHTML = '';
            
            let filteredFoods = foodDatabase;
            if (currentCategory !== 'all') {
                filteredFoods = foodDatabase.filter(food => food.category === currentCategory);
            }
            
            if (filteredFoods.length === 0) {
                categoryFoods.innerHTML = '<div class="food-item">לא נמצאו מוצרים בקטגוריה זו</div>';
                return;
            }
            
            filteredFoods.forEach(food => {
                const div = document.createElement('div');
                div.className = 'food-item';
                div.innerHTML = `${food.name} - ${food.calories} קלוריות`;
                div.onclick = () => showFoodDetails(food, 'categoryDetails');
                categoryFoods.appendChild(div);
            });
        }

        // חיפוש מזון
        function searchFood() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            const results = document.getElementById('searchResults');
            results.innerHTML = '';
            
            if (query.length < 2) {
                results.innerHTML = '<div class="food-item">הקלד לפחות 2 תווים לחיפוש</div>';
                return;
            }
            
            const filteredFoods = foodDatabase.filter(food => 
                food.name.toLowerCase().includes(query)
            );
            
            if (filteredFoods.length === 0) {
                results.innerHTML = '<div class="food-item">לא נמצאו תוצאות</div>';
                return;
            }
            
            filteredFoods.forEach(food => {
                const div = document.createElement('div');
                div.className = 'food-item';
                div.innerHTML = `${food.name} - ${food.calories} קלוריות`;
                div.onclick = () => showFoodDetails(food, 'foodDetails');
                results.appendChild(div);
            });
        }

        // הצגת פרטי מזון
        function showFoodDetails(food, elementId) {
            const detailsElement = document.getElementById(elementId);
            
            let vitaminsHTML = '';
            if (food.vitamins) {
                vitaminsHTML = '<div class="vitamins-grid">';
                for (const [vitamin, value] of Object.entries(food.vitamins)) {
                    vitaminsHTML += `
                        <div class="vitamin-item">
                            <div class="vitamin-name">${vitamin}</div>
                            <div class="vitamin-value">${value}</div>
                        </div>
                    `;
                }
                vitaminsHTML += '</div>';
            }
            
            detailsElement.innerHTML = `
                <h3>${food.name}</h3>
                <table>
                    <tr><th>ערך תזונתי</th><th>ל-100 גרם</th></tr>
                    <tr><td>קלוריות</td><td>${food.calories}</td></tr>
                    <tr><td>פחמימות</td><td>${food.carbs} גרם</td></tr>
                    <tr><td>חלבונים</td><td>${food.protein} גרם</td></tr>
                    <tr><td>שומנים</td><td>${food.fat} גרם</td></tr>
                    <tr><td>סיבים</td><td>${food.fiber} גרם</td></tr>
                </table>
                ${vitaminsHTML ? '<h4>ויטמינים ומינרלים:</h4>' + vitaminsHTML : ''}
            `;
        }

        // הוספת מזון למחשבון
        function addToCalculator() {
            const foodId = document.getElementById('foodSelect').value;
            const amount = parseFloat(document.getElementById('amountInput').value);
            
            if (!foodId || !amount || isNaN(amount)) {
                alert('נא לבחור מזון ולהזין כמות');
                return;
            }
            
            const food = foodDatabase.find(item => item.id == foodId);
            if (!food) return;
            
            // חישוב ערכים לפי הכמות
            const ratio = amount / 100;
            const foodWithAmount = {
                ...food,
                amount: amount,
                calculatedCalories: food.calories * ratio,
                calculatedCarbs: food.carbs * ratio,
                calculatedProtein: food.protein * ratio,
                calculatedFat: food.fat * ratio,
                calculatedFiber: food.fiber * ratio
            };
            
            selectedFoods.push(foodWithAmount);
            updateCalculator();
        }

        // עדכון המחשבון
        function updateCalculator() {
            const selectedFoodsElement = document.getElementById('selectedFoods');
            selectedFoodsElement.innerHTML = '';
            
            selectedFoods.forEach((food, index) => {
                const div = document.createElement('div');
                div.className = 'calculator-item';
                div.innerHTML = `
                    <span>${food.name} - ${food.amount}גרם</span>
                    <button onclick="removeFood(${index})"><i class="fas fa-trash"></i> הסר</button>
                `;
                selectedFoodsElement.appendChild(div);
            });
            
            updateNutritionSummary();
        }

        // הסרת מזון מהמחשבון
        function removeFood(index) {
            selectedFoods.splice(index, 1);
            updateCalculator();
        }

        // עדכון הסיכום התזונתי
        function updateNutritionSummary() {
            const summaryElement = document.getElementById('nutritionSummary');
            
            if (selectedFoods.length === 0) {
                summaryElement.innerHTML = 'טרם נוספו מזונות';
                return;
            }
            
            const totalCalories = selectedFoods.reduce((sum, food) => sum + food.calculatedCalories, 0);
            const totalCarbs = selectedFoods.reduce((sum, food) => sum + food.calculatedCarbs, 0);
            const totalProtein = selectedFoods.reduce((sum, food) => sum + food.calculatedProtein, 0);
            const totalFat = selectedFoods.reduce((sum, food) => sum + food.calculatedFat, 0);
            const totalFiber = selectedFoods.reduce((sum, food) => sum + food.calculatedFiber, 0);
            
            summaryElement.innerHTML = `
                <h3>סיכום תזונתי:</h3>
                <table>
                    <tr><th>ערך תזונתי</th><th>סך הכל</th></tr>
                    <tr><td>קלוריות</td><td>${totalCalories.toFixed(1)}</td></tr>
                    <tr><td>פחמימות</td><td>${totalCarbs.toFixed(1)} גרם</td></tr>
                    <tr><td>חלבונים</td><td>${totalProtein.toFixed(1)} גרם</td></tr>
                    <tr><td>שומנים</td><td>${totalFat.toFixed(1)} גרם</td></tr>
                    <tr><td>סיבים</td><td>${totalFiber.toFixed(1)} גרם</td></tr>
                </table>
            `;
        }

        // חישוב צרכים קלוריים
        function calculateCalories() {
            const weight = parseFloat(document.getElementById('weightInput').value);
            const height = parseFloat(document.getElementById('heightInput').value);
            const age = parseFloat(document.getElementById('ageInput').value);
            const gender = document.getElementById('genderSelect').value;
            const activity = parseFloat(document.getElementById('activitySelect').value);
            const goal = document.getElementById('goalSelect').value;
            
            if (!weight || !height || !age) {
                alert('נא למלא את כל השדות עם ערכים מספריים');
                return;
            }
            
            // חישוב BMR (Basal Metabolic Rate)
            let bmr;
            if (gender === 'male') {
                bmr = 10 * weight + 6.25 * height - 5 * age + 5;
            } else {
                bmr = 10 * weight + 6.25 * height - 5 * age - 161;
            }
            
            // התאמה לפי רמת פעילות
            const tdee = bmr * activity;
            
            // התאמה לפי מטרה
            let calories, recommendation;
            if (goal === 'lose') {
                calories = tdee - 500;
                recommendation = `לצורך ירידה במשקל, מומלץ לצרוך ${calories.toFixed(0)} קלוריות ליום`;
            } else if (goal === 'gain') {
                calories = tdee + 500;
                recommendation = `לצורך עלייה במשקל, מומלץ לצרוך ${calories.toFixed(0)} קלוריות ליום`;
            } else {
                calories = tdee;
                recommendation = `לצורך שמירה על משקל, מומלץ לצרוך ${calories.toFixed(0)} קלוריות ליום`;
            }
            
            // הצגת התוצאות
            const resultElement = document.getElementById('calorieResult');
            resultElement.innerHTML = `
                <h3>תוצאות החישוב:</h3>
                <p>חילוף חומרים בסיסי (BMR): ${bmr.toFixed(0)} קלוריות</p>
                <p>סך הוצאה קלורית יומית (TDEE): ${tdee.toFixed(0)} קלוריות</p>
                <p><strong>${recommendation}</strong></p>
                <p>הערות: הערכים הם הערכה ומשתנים מאדם לאדם. לדיוק רב יותר מומלץ להתייעץ עם תזונאי/ת.</p>
            `;
        }

        // חיפוש מזון באינטרנט (מדומה)
        function searchFoodOnline() {
            const query = document.getElementById('webSearchInput').value.trim();
            const resultsContainer = document.getElementById('webSearchResults');
            
            if (!query) {
                resultsContainer.innerHTML = '<div class="web-search-result">נא להזין שם מזון לחיפוש</div>';
                return;
            }
            
            // הדמיית חיפוש באינטרנט
            resultsContainer.innerHTML = `
                <div class="web-search-result">
                    <h4>מחפש ברשת עבור: ${query}</h4>
                    <p>מתחבר לשרתי שופרסל, חצי חינם ומאגרי מזון...</p>
                </div>
            `;
            
            // הדמיית זמן טעינה
            setTimeout(() => {
                // תוצאות מדומות
                const mockResults = [
                    {
                        name: `${query} (תוצאה משופרסל)`,
                        category: "other",
                        calories: Math.floor(Math.random() * 100) + 100,
                        carbs: Math.floor(Math.random() * 20) + 5,
                        protein: Math.floor(Math.random() * 10) + 2,
                        fat: Math.floor(Math.random() * 10) + 1,
                        fiber: Math.floor(Math.random() * 5),
                        vitamins: {
                            "ויטמין C": `${Math.floor(Math.random() * 50)} mg`,
                            "סידן": `${Math.floor(Math.random() * 100)} mg`
                        }
                    },
                    {
                        name: `${query} (תוצאה מחצי חינם)`,
                        category: "other",
                        calories: Math.floor(Math.random() * 100) + 100,
                        carbs: Math.floor(Math.random() * 20) + 5,
                        protein: Math.floor(Math.random() * 10) + 2,
                        fat: Math.floor(Math.random() * 10) + 1,
                        fiber: Math.floor(Math.random() * 5),
                        vitamins: {
                            "ויטמין A": `${Math.floor(Math.random() * 5000)} IU`,
                            "ברזל": `${Math.floor(Math.random() * 5)} mg`
                        }
                    }
                ];
                
                let resultsHTML = '';
                mockResults.forEach((food, index) => {
                    resultsHTML += `
                        <div class="web-search-result">
                            <h4>${food.name}</h4>
                            <p>קלוריות: ${food.calories} | פחמימות: ${food.carbs}ג | חלבון: ${food.protein}ג | שומן: ${food.fat}ג</p>
                            <button onclick="addSearchedFood(${index})">הוסף למאגר</button>
                            <div id="foodDetails${index}" style="display:none">${JSON.stringify(food)}</div>
                        </div>
                    `;
                });
                
                resultsContainer.innerHTML = resultsHTML;
            }, 2000);
        }

        // הוספת מזון שנמצא בחיפוש
        function addSearchedFood(index) {
            const foodDetails = document.getElementById(`foodDetails${index}`).textContent;
            const food = JSON.parse(foodDetails);
            
            // הוספת מזון חדש למאגר
            food.id = Math.max(...foodDatabase.map(f => f.id)) + 1;
            foodDatabase.push(food);
            
            // הודעה על הצלחה
            alert(`המזון "${food.name}" נוסף בהצלחה למאגר!`);
            
            // ריענון הרשימות
            initApp();
        }

        // מחיקת מזון מהמאגר
        function deleteFood() {
            const foodId = document.getElementById('deleteFoodSelect').value;
            const password = document.getElementById('deletePassword').value;
            
            if (!foodId) {
                alert('נא לבחור מזון למחיקה');
                return;
            }
            
            if (password !== DELETE_PASSWORD) {
                alert('סיסמה לא תקינה');
                return;
            }
            
            // חיפוש המזון
            const foodIndex = foodDatabase.findIndex(food => food.id == foodId);
            
            if (foodIndex === -1) {
                alert('מזון לא נמצא');
                return;
            }
            
            // מחיקת המזון
            const foodName = foodDatabase[foodIndex].name;
            foodDatabase.splice(foodIndex, 1);
            
            // הודעה על הצלחה
            alert(`המזון "${foodName}" נמחק בהצלחה מהמאגר!`);
            
            // ריענון הרשימות
            initApp();
            
            // איפוס שדה הסיסמה
            document.getElementById('deletePassword').value = '';
        }

        // הוספת מזון ידנית
        function addManualFood() {
            const name = document.getElementById('manualFoodName').value.trim();
            const category = document.getElementById('manualFoodCategory').value;
            const calories = parseFloat(document.getElementById('manualFoodCalories').value);
            const carbs = parseFloat(document.getElementById('manualFoodCarbs').value);
            const protein = parseFloat(document.getElementById('manualFoodProtein').value);
            const fat = parseFloat(document.getElementById('manualFoodFat').value);
            const fiber = parseFloat(document.getElementById('manualFoodFiber').value);
            const vitaminsText = document.getElementById('manualFoodVitamins').value;
            
            if (!name || isNaN(calories) || isNaN(carbs) || isNaN(protein) || isNaN(fat) || isNaN(fiber)) {
                alert('נא למלא את כל השדות הנדרשים עם ערכים מספריים');
                return;
            }
            
            // עיבוד ויטמינים
            const vitamins = {};
            if (vitaminsText) {
                const vitaminPairs = vitaminsText.split(',');
                vitaminPairs.forEach(pair => {
                    const [key, value] = pair.split(':').map(item => item.trim());
                    if (key && value) {
                        vitamins[key] = value;
                    }
                });
            }
            
            // יצירת מזון חדש
            const newFood = {
                id: Math.max(...foodDatabase.map(f => f.id)) + 1,
                name,
                category,
                calories,
                carbs,
                protein,
                fat,
                fiber,
                vitamins
            };
            
            // הוספה למאגר
            foodDatabase.push(newFood);
            
            // הודעה על הצלחה
            alert(`המזון "${name}" נוסף בהצלחה למאגר!`);
            
            // ריענון הרשימות
            initApp();
            
            // ניקוי הטופס
            document.getElementById('manualFoodName').value = '';
            document.getElementById('manualFoodCalories').value = '';
            document.getElementById('manualFoodCarbs').value = '';
            document.getElementById('manualFoodProtein').value = '';
            document.getElementById('manualFoodFat').value = '';
            document.getElementById('manualFoodFiber').value = '';
            document.getElementById('manualFoodVitamins').value = '';
        }

        // אתחול האפליקציה בעת טעינת הדף
        window.onload = initApp;
    </script>
</body>
</html>